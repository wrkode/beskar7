# Adds namespace to all resources.
namespace: beskar7-system

# Value of this field is prepended to the
# names of all resources, e.g. a deployment named
# "controller-manager" becomes "beskar7-controller-manager".
namePrefix: beskar7-

# Labels to add to all resources and selectors.
commonLabels:
  app.kubernetes.io/name: beskar7
  app.kubernetes.io/instance: manager
  app.kubernetes.io/component: controller
  app.kubernetes.io/part-of: beskar7
  app.kubernetes.io/managed-by: kustomize

# [CERTMANAGER] To enable cert-manager, uncomment all sections with 'CERTMANAGER'
# [CERTMANAGER] Uncomment 'CERTMANAGER' sections in crd/kustomization.yaml to enable the CA injection in the admission webhooks.
# 'CERTMANAGER' is just a marker here, you can remove it, and remove the comment in the below line.
#- ../certmanager

# [CERTMANAGER] If you want use cert-manager, uncomment the 'CERTMANAGER' lines in crd/kustomization.yaml and the following line.
#- ../webhook

# [CERTMANAGER] If you want use cert-manager, uncomment the 'CERTMANAGER' lines in crd/kustomization.yaml and the following line.
#- ../certmanager

resources:
- ../crd
- ../rbac
- ../manager
- ../webhook

# Mount the controller config file for loading manager configurations
# through a ComponentConfig type
#- manager_config_patch.yaml

# TODO(user): Add transformations like Annotations, Labels, ConfigMapReplacements


# Images for the Beskar7 manager. The image name `controller` must match
# the name used in config/manager/manager.yaml.
images:
- name: beskar-controller
  newName: ghcr.io/wrkode/beskar7/ # Uses Makefile vars by default
  newTag: v0.1.0-dev         # Uses Makefile vars by default

patches:
- path: manager_auth_proxy_patch.yaml
  target:
    kind: Deployment
    name: controller-manager
- path: manager_webhook_patch.yaml
  target:
    kind: Deployment
    name: controller-manager
- path: manager_prometheus_metrics_patch.yaml
  target:
    kind: Deployment
    name: controller-manager 